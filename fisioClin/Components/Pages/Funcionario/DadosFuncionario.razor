@page "/dadosfuncionario/{id:int}"
@using fisioClin.Models;
@inject FuncionariosDAO FuncionariosDAO
@inject CargoDAO CargoDAO

@code {
    [Parameter]
    public int id { get; set; }

    private Funcionarios funcionario = new();
    private Cargo cargo = new();
    private bool isLoading = true;

    protected override void OnInitialized()
    {
        if (id > 0)
        {
            funcionario = FuncionariosDAO.BuscarPorId(id);
            if (funcionario != null && funcionario.Id_Cargo_fk.HasValue)
                cargo = CargoDAO.BuscarPorId(funcionario.Id_Cargo_fk.Value);
        }

        if (funcionario == null)
            funcionario = new Funcionarios();

        isLoading = false;
    }
}

@if (isLoading)
{
    <div class="loading-message">Carregando dados do funcionário...</div>
}
else if (funcionario == null)
{
    <div class="not-found-message">Funcionário não encontrado. ID: @id</div>
}
else
{
    <div class="container mt-4">

        <!-- TÍTULO -->
        <div class="d-flex align-items-center mb-4">
            <h3 class="fw-bold" style="color:#701a1a;">Dados do Funcionário</h3>

            <input type="text"
                   class="form-control ms-3"
                   style="max-width: 80px;"
                   readonly
                   value="@funcionario.Id" />

            <input type="text"
                   class="form-control ms-2"
                   readonly
                   value="@funcionario.Nome" />
        </div>

        <!-- CARD PRINCIPAL -->
        <div class="card shadow-sm border-0">
            <div class="card-body">

                <div class="row">
                    <div class="col-md-9">

                        <!-- Nome -->
                        <div class="mb-3">
                            <label class="form-label fw-semibold">Nome Completo</label>
                            <input type="text" class="form-control" readonly value="@funcionario.Nome" />
                        </div>

                        <!-- Documentos -->
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label class="form-label fw-semibold">CPF</label>
                                <input type="text" class="form-control" readonly value="@funcionario.Cpf" />
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-semibold">RG</label>
                                <input type="text" class="form-control" readonly value="@funcionario.Rg" />
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-semibold">Data de Nascimento</label>
                                <input type="text" class="form-control" readonly value="@funcionario.DataNascimento?.ToString("dd/MM/yyyy")" />
                            </div>
                        </div>

                        <!-- Contato -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">Email</label>
                                <input type="text" class="form-control" readonly value="@funcionario.Email" />
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">Telefone</label>
                                <input type="text" class="form-control" readonly value="@funcionario.Telefone" />
                            </div>
                        </div>

                        <!-- Profissional -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">Especialidade</label>
                                <input type="text" class="form-control" readonly value="@funcionario.Especialidade" />
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">Registro Profissional</label>
                                <input type="text" class="form-control" readonly value="@funcionario.RegistroProfissional" />
                            </div>
                        </div>

                        <!-- Contrato -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">Tipo de Vínculo</label>
                                <input type="text" class="form-control" readonly value="@funcionario.TipoVinculo" />
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-semibold">Data de Contratação</label>
                                <input type="text" class="form-control" readonly value="@funcionario.DataContratacao?.ToString("dd/MM/yyyy")" />
                            </div>
                        </div>

                        <!-- Cargo -->
                        <div class="mb-3">
                            <label class="form-label fw-semibold">Cargo</label>
                            <input type="text" class="form-control" readonly value="@cargo?.Nome" />
                        </div>

                        <!-- Certificados -->
                        <div class="mb-3">
                            <label class="form-label fw-semibold">Certificados</label>
                            <input type="text" class="form-control" readonly value="@funcionario.Certificados" />
                        </div>

                    </div>

                    <!-- Ícone igual ao padrão -->
                    <div class="col-md-3 d-flex flex-column align-items-center mt-3 mt-md-0">
                        <i class="bi bi-person-badge"
                           style="font-size: 130px; color: #701a1a;"></i>
                    </div>

                </div>

            </div>
        </div>
    </div>
}
