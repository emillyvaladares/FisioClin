@page "/dadosfuncionario"
@using fisioClin.Models;
@inject FuncionariosDAO FuncionarioDAO

<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dados Funcionário - Clínica</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <style>
        /* --- CSS Personalizado para o Tema (Mantendo as cores vinho) --- */

        :root {
            --primary-color: #72142e;
            --secondary-color: #a0405c;
            --card-background: #ffffff;
            --border-color: #cccccc;
        }

        /* Estilos da Navegação */
        .custom-navbar {
            display: flex; background-color: var(--primary-color); color: white; padding: 0 10px; height: 60px; align-items: center; overflow-x: auto;
        }
        .custom-navbar > div { width: 100%; display: flex; align-items: center; }
        .nav-item { padding: 10px 15px; cursor: pointer; font-size: 14px; white-space: nowrap; transition: background-color 0.2s; }
        .nav-item:hover:not(.menu-icon, .right-arrow) { background-color: var(--secondary-color); }
        .nav-item.active { background-color: transparent !important; }
        .nav-item.nav-funcionario { background-color: var(--secondary-color); font-weight: bold; border-radius: 4px 4px 0 0; }
        .employee-header-card { display: flex; align-items: center; background-color: var(--card-background); border: 1px solid var(--border-color); }
        .record-number { font-weight: bold; color: var(--primary-color); font-size: 1.1em; }

        /* Estilos do Card Principal */
        .employee-data-card h2 { color: var(--primary-color); font-weight: 600; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        .form-label { font-size: 0.9em; color: #666; margin-bottom: 5px; }

        /* Imagem */
        .employee-image-container { width: 180px; height: 180px; overflow: hidden; flex-shrink: 0; position: relative; }
        .employee-image { width: 100%; height: 100%; object-fit: cover; }
        .edit-icon { position: absolute; bottom: 0; right: 0; background-color: var(--primary-color); color: white; border-radius: 50%; padding: 5px; cursor: pointer; font-size: 18px; line-height: 1; border: 2px solid white; }
        
        /* Botões */
        .custom-edit-btn { background-color: var(--primary-color); color: white; font-weight: bold; padding: 10px 20px; transition: background-color 0.2s; }
        .custom-edit-btn:hover { background-color: var(--secondary-color); color: white; }

       
    </style>
</head>
<body>
    

    <div class="container-fluid mt-3">
        
        <div class="card p-2 mb-4 employee-header-card">
            <span class="record-number me-3">987</span>
            <span class="employee-name-header">Nome do Funcionário Carregado</span>
        </div>
        
        <div class="card employee-data-card shadow-sm p-4">
            <h2 class="card-title mb-4">Dados Funcionário</h2>
            
            <form id="employeeForm" method="post">
                
                <div class="row g-4">
                    
                    <div class="col-lg-8 col-12">
                        <div class="row g-3">
                            
                            <div class="col-12">
                                <label for="nome" class="form-label">Nome completo</label>
                                <input type="text" class="form-control" id="nome" name="nome" placeholder="Nome completo do funcionário" required disabled>
                            </div>

                            <div class="col-md-6 col-12">
                                <label for="cpf" class="form-label">CPF</label>
                                <input type="text" class="form-control" id="cpf" name="cpf" placeholder="000.000.000-00" required disabled>
                            </div>
                            <div class="col-md-6 col-12">
                                <label for="cargo" class="form-label">Cargo</label>
                                <select id="cargo" name="cargo" class="form-select" disabled>
                                    <option value="" disabled selected>Selecione o cargo</option>
                                    <option value="Fisioterapeuta">Fisioterapeuta</option>
                                    <option value="Secretaria">Secretaria</option>
                                    <option value="Administrador">Administrador</option>
                                </select>
                            </div>
                            
                            <div class="col-md-6 col-12">
                                <label for="rg" class="form-label">RG</label>
                                <input type="text" class="form-control" id="rg" name="rg" placeholder="00.000.000-0" disabled>
                            </div>
                            <div class="col-md-6 col-12">
                                <label for="admissao">Data de Admissão</label>
                                <input type="date" class="form-control" id="admissao" name="admissao" required disabled>
                            </div>
                            
                            <div class="col-md-6 col-12">
                                <label for="dataNascimento" class="form-label">Data de Nascimento</label>
                                <input type="date" class="form-control" id="dataNascimento" name="dataNascimento" required disabled>
                            </div>
                            <div class="col-md-6 col-12">
                                <label for="cep" class="form-label">CEP</label>
                                <input type="text" class="form-control" id="cep" name="cep" placeholder="00000-000" disabled>
                            </div>
                            
                            <div class="col-md-6 col-12">
                                <label for="sexo" class="form-label">Sexo</label>
                                <select id="sexo" name="sexo" class="form-select" disabled>
                                    <option value="" disabled selected>Selecione</option>
                                    <option value="Feminino">Feminino</option>
                                    <option value="Masculino">Masculino</option>
                                    <option value="Outro">Outro</option>
                                </select>
                            </div>
                            <div class="col-md-6 col-12">
                                <label for="rua" class="form-label">Rua</label>
                                <input type="text" class="form-control" id="rua" name="rua" placeholder="Rua" disabled>
                            </div>

                            <div class="col-md-6 col-12">
                                <label for="email" class="form-label">Email</label>
                                <input type="email" class="form-control" id="email" name="email" placeholder="email@exemplo.com" disabled>
                            </div>
                            <div class="col-md-6 col-12">
                                <label for="telefone" class="form-label">Telefone</label>
                                <input type="tel" class="form-control" id="telefone" name="telefone" placeholder="(99) 99999-9999" disabled>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-4 col-12 d-flex flex-column align-items-center">
                        
                        <div class="col-12 mb-4">
                            <label for="salario" class="form-label">Salário/Remuneração</label>
                            <input type="text" class="form-control" id="salario" name="salario" placeholder="R$ 0.000,00" required disabled>
                        </div>

                        <div class="employee-image-container mb-4">
                            <img src="https://via.placeholder.com/180/72142e/ffffff?text=Funcionario" alt="Foto do Funcionário" class="employee-image rounded-circle img-fluid">
                            <i class="material-icons edit-icon">edit</i>
                        </div>
                    </div>

                </div>
                
                <div class="d-flex justify-content-end gap-3 mt-4 pt-3 border-top">
                    
                    <button type="submit" class="btn custom-edit-btn" id="saveButton" style="display: none;">Salvar Alterações</button> 
                    
                    <button type="button" class="btn custom-edit-btn" id="editButton">Editar</button> 
                    
                    <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteModal">Excluir</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteModalLabel">Confirmação de Exclusão</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Tem certeza que deseja EXCLUIR este funcionário? Esta ação é irreversível.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Excluir Permanentemente</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('employeeForm');
            const editButton = document.getElementById('editButton');
            const saveButton = document.getElementById('saveButton');
            const formFields = form.querySelectorAll('input, select');
            const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');

            // --- Lógica de Edição ---
            function toggleEditMode(enable) {
                formFields.forEach(field => {
                    // O atributo 'disabled' controla o estado de somente leitura
                    field.disabled = !enable;
                });

                if (enable) {
                    editButton.style.display = 'none';
                    saveButton.style.display = 'inline-block';
                    console.log('Modo de Edição Ativado.');
                } else {
                    editButton.style.display = 'inline-block';
                    saveButton.style.display = 'none';
                    console.log('Modo de Visualização (somente leitura).');
                }
            }

            // Ativa o modo de edição ao clicar no botão "Editar"
            editButton.addEventListener('click', () => {
                toggleEditMode(true);
            });

            // Lógica de envio do formulário (Botão Salvar)
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                console.log('Dados prontos para envio. (Funcionário POST/PUT)');
                alert('Ação: SALVAR ALTERAÇÕES enviada para a Controller Razor.');
                
                // Opcional: Voltar para o modo de visualização após salvar
                // toggleEditMode(false); 
            });

            // Lógica de exclusão
            confirmDeleteBtn.addEventListener('click', () => {
                const deleteModal = bootstrap.Modal.getInstance(document.getElementById('deleteModal'));
                deleteModal.hide(); 
                alert('Ação: EXCLUIR (Sua Controller Razor processará o DELETE)');
            });

            // Edição de foto (apenas alerta)
            document.querySelector('.edit-icon').addEventListener('click', () => {
                alert('Funcionalidade: Upload/Mudança de foto do funcionário.');
            });

            // Garante que o modo de visualização está ativo ao carregar a página
            toggleEditMode(false);
        });
    </script>
</body>
</html>