@page "/paciente"
@using fisioClin.Models
@inject PacienteDAO pacienteDAO

@code {
    private List<Paciente> pacientes = new();
    private string nomeBusca = "";

    protected override void OnInitialized()
    {
        // Carrega todos os pacientes ao abrir a página
        pacientes = pacienteDAO.ListarTodos();
    }

    private void FiltrarPacientes()
    {
        if (string.IsNullOrWhiteSpace(nomeBusca))
        {
            pacientes = pacienteDAO.ListarTodos();
        }
        else
        {
            pacientes = pacienteDAO.ListarTodos()
                .Where(p => p.Nome.Contains(nomeBusca, StringComparison.OrdinalIgnoreCase))
                .ToList();
        }
    }
}
<div class="container mt-4">
    <h3 class="mb-4 titulo">Dados Pacientes</h3>

    <!-- Campo de pesquisa -->
    <div class="input-group mb-3">
        <span class="input-group-text material-icons">arrow_back</span>
        <input type="text" class="form-control" placeholder="Pesquisar Paciente" @bind="nomeBusca" @bind:event="oninput" />
        <button class="btn btn-outline-secondary" @onclick="FiltrarPacientes">
            <span class="material-icons">search</span>
        </button>
    </div>

    <!-- Tabela -->
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>ID</th>
                <th>Nome</th>
            </tr>
        </thead>
        <tbody>
            @if (pacientes == null || pacientes.Count == 0)
            {
                <tr>
                    <td colspan="2" class="text-center text-muted">Nenhum paciente encontrado.</td>
                </tr>
            }
            else
            {
                @foreach (var p in pacientes)
                {
                    <tr>
                        <td class="id-col">@p.Id</td>
                        <td>@p.Nome</td>
                    </tr>
                }
            }
        </tbody>
    </table>

    <!-- Botão de cadastrar -->
    <div class="d-flex justify-content-end mt-3">
        <a href="/cadastro" class="btn btn-cadastrar">Cadastrar Paciente</a>
    </div>
</div>

<style>
    body {
        background-color: #f4f1f1;
    }

    .titulo {
        color: #600000;
        font-weight: 600;
    }

    .input-group-text {
        background-color: #fff;
        border-right: none;
    }

    .form-control {
        border-left: none;
        border-right: none;
    }

    .table {
        background-color: #fff;
    }

    .id-col {
        width: 70px;
        text-align: center;
        color: #600000;
        font-weight: 600;
    }

    .btn-cadastrar {
        background-color: #600000;
        color: white;
        font-weight: 500;
        border-radius: 6px;
        padding: 10px 20px;
        text-decoration: none;
        transition: 0.3s;
    }

        .btn-cadastrar:hover {
            background-color: #800000;
            color: #fff;
        }
</style>
